<!-- welcome.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome</title>
</head>
<body>

<script>
    function getParameterByName(name) {
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(window.location.href);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    var enteredName = getParameterByName('name');

    // Funkcia na získanie počtu bodov z lokálneho úložiska
    function getUserPoints(name) {
        var storedPoints = localStorage.getItem(name);
        return storedPoints ? parseInt(storedPoints) : 0;
    }

    // Funkcia na aktualizáciu a uloženie počtu bodov do lokálneho úložiska
    function updateUserPoints(name, newPoints) {
        localStorage.setItem(name, newPoints.toString());
    }

    // Retrieve the point value for the entered user
    var userPointValue = getUserPoints(enteredName);

    // Set the remaining points to be the same as userPointValue initially
    var remainingPoints = userPointValue;

    document.write('<h1>Vitaj, ' + enteredName + '!</h1>');
    document.write('<p>Tvoj momentálny počet bodov: ' + userPointValue + '</p>');
    document.write('<p>Vďaka tvojim bodom si môžeš objednať ktorúkoľvek vec v e-shope, na ktorú máš dostatočný počet bodov.</p>');

    var items = [
        { name: 'Item 1', points: 50 },
        { name: 'Item 2', points: 75 },
        { name: 'Item 3', points: 100 }
    ];

    document.write('<h2>Dostupné objekty na objednanie:</h2>');
    document.write('<ul>');

    for (var i = 0; i < items.length; i++) {
        var item = items[i];
        document.write('<li>' + item.name + ' - ' + item.points + ' bodov <button onclick="orderItem(\'' + item.name + '\', ' + item.points + ')">Objednať</button></li>');
    }

    document.write('</ul>');

    function orderItem(itemName, itemPoints) {
        if (remainingPoints >= itemPoints) {
            remainingPoints -= itemPoints;

            // Aktualizuj a ulož počet bodov pre používateľa
            updateUserPoints(enteredName, remainingPoints);

            document.write('<p>Objednal si si ' + itemName + '. Tvoj zostávajúci počet bodov: ' + remainingPoints + '</p>');
        } else {
            document.write('<p>Nemáš dostatok bodov na objednanie ' + itemName + '.</p>');
        }

        // Pridaj tlačidlo na návrat späť na predchádzajúcu stránku
        document.write('<button onclick="goBack()">Späť</button>');
    }
    function orderItem(itemName, itemPoints) {
        if (remainingPoints >= itemPoints) {
            remainingPoints -= itemPoints;

            // Aktualizuj a ulož počet bodov pre používateľa
            updateUserPoints(enteredName, remainingPoints);

            // Ulož informácie o objednávke do localStorage
            var orderDetails = { itemName: itemName, points: itemPoints };
            localStorage.setItem(enteredName, JSON.stringify(orderDetails));

            document.write('<p>Objednal si si ' + itemName + '. Tvoj zostávajúci počet bodov: ' + remainingPoints + '</p>');
        } else {
            document.write('<p>Nemáš dostatok bodov na objednanie ' + itemName + '.</p>');
        }

        // Pridaj tlačidlo na návrat späť na predchádzajúcu stránku
        document.write('<button onclick="goBack()">Späť</button>');
    }

    // Funkcia na návrat späť na predchádzajúcu stránku
    function goBack() {
        location.reload();
    }
</script>

</body>
</html>
